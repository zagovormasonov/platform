# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ—Ç–ª–∞–¥–∫–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∑–∞–Ω—è—Ç–∏–π

## üêõ –ü—Ä–æ–±–ª–µ–º–∞: –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–º

### üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

#### 1. –ü–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏ (–≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
–ü—Ä–∏ `NODE_ENV=development` –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∂–µ–ª—Ç–∞—è –ø–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏:
- ‚úÖ **–í—Å–µ–≥–æ —Å–ª–æ—Ç–æ–≤** - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
- ‚úÖ **–î–æ—Å—Ç—É–ø–Ω—ã—Ö** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ (`is_available: true`)
- ‚úÖ **–ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ (`is_available: false`)
- ‚úÖ **–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π

#### 2. –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
–û—Ç–∫—Ä—ã–≤ DevTools ‚Üí Console, –≤—ã —É–≤–∏–¥–∏—Ç–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏:
```
–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã: [...]
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ—Ç–æ–≤: 10
–ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã: [...]
–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: [...]
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π: 2
–°–ª–æ—Ç 09:00-10:00: –¥–æ—Å—Ç—É–ø–µ–Ω=true, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ=undefined
–°–ª–æ—Ç 10:00-11:00: –¥–æ—Å—Ç—É–ø–µ–Ω=false, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ={client_name: "–ò–≤–∞–Ω"}
```

### üîß –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### –ü—Ä–∏—á–∏–Ω–∞ 1: –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
**–°–∏–º–ø—Ç–æ–º—ã:**
- –í—Å–µ —Å–ª–æ—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å–∏–Ω–∏–º–∏
- –í –ø–∞–Ω–µ–ª–∏ –æ—Ç–ª–∞–¥–∫–∏: "–ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö: 0", "–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π: 0"

**–†–µ—à–µ–Ω–∏–µ:**
1. **–°–æ–∑–¥–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä—Ç–∞** –≤ –ø—Ä–æ—Ñ–∏–ª–µ
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É "–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"** –≤ –ø–∞–Ω–µ–ª–∏ –æ—Ç–ª–∞–¥–∫–∏
3. –ò–ª–∏ **–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ—Ç** –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

#### –ü—Ä–∏—á–∏–Ω–∞ 2: –¢—Ä–∏–≥–≥–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–°–∏–º–ø—Ç–æ–º—ã:**
- –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –µ—Å—Ç—å, –Ω–æ —Å–ª–æ—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏
- –í –ª–æ–≥–∞—Ö: `–¥–æ—Å—Ç—É–ø–µ–Ω=true` –¥–∞–∂–µ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–∞:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞
SELECT * FROM pg_trigger WHERE tgname = 'update_slot_availability_trigger';

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é
SELECT proname FROM pg_proc WHERE proname = 'update_slot_availability';
```

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä
DROP TRIGGER IF EXISTS update_slot_availability_trigger ON bookings;
CREATE TRIGGER update_slot_availability_trigger
    AFTER INSERT OR UPDATE OR DELETE ON bookings
    FOR EACH ROW EXECUTE FUNCTION update_slot_availability();
```

#### –ü—Ä–∏—á–∏–Ω–∞ 3: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏
**–°–∏–º–ø—Ç–æ–º—ã:**
- –°–ª–æ—Ç—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
- –í –∫–æ–Ω—Å–æ–ª–∏ –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–∏—Ç–∏–∫:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è time_slots
SELECT * FROM pg_policies WHERE tablename = 'time_slots';

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è bookings
SELECT * FROM pg_policies WHERE tablename = 'bookings';
```

#### –ü—Ä–∏—á–∏–Ω–∞ 4: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å –¥–∞–Ω–Ω—ã—Ö
**–°–∏–º–ø—Ç–æ–º—ã:**
- –í –ª–æ–≥–∞—Ö: `–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ=undefined` –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ—Ç–æ–≤
- –°–ª–æ—Ç—ã –∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ —Å–≤—è–∑—ã–≤–∞—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å–ª–æ—Ç–∞—Ö –∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è—Ö
SELECT 
    ts.start_time as slot_start,
    ts.end_time as slot_end,
    b.start_time as booking_start,
    b.end_time as booking_end,
    ts.is_available
FROM time_slots ts
LEFT JOIN bookings b ON b.slot_id = ts.id
WHERE ts.slot_date >= CURRENT_DATE
ORDER BY ts.slot_date, ts.start_time;
```

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

#### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
1. –í–æ–π—Ç–∏ –∫–∞–∫ —ç–∫—Å–ø–µ—Ä—Ç
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ "–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å"
3. –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ 09:00-18:00, 60 –º–∏–Ω)
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å–ª–æ—Ç—ã

#### –®–∞–≥ 2: –¢–µ—Å—Ç–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –û—Ç–∫—Ä—ã—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å —ç–∫—Å–ø–µ—Ä—Ç–∞
2. –ù–∞–∂–∞—Ç—å "–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ" –≤ –ø–∞–Ω–µ–ª–∏ –æ—Ç–ª–∞–¥–∫–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–ª–æ—Ç —Å—Ç–∞–ª –∫—Ä–∞—Å–Ω—ã–º

#### –®–∞–≥ 3: –†–µ–∞–ª—å–Ω–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –í–æ–π—Ç–∏ –∫–∞–∫ –¥—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
2. –ù–∞–π—Ç–∏ —ç–∫—Å–ø–µ—Ä—Ç–∞ –≤ –ø–æ–∏—Å–∫–µ
3. –û—Ç–∫—Ä—ã—Ç—å –µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—å
4. –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–π —Å–ª–æ—Ç
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–ª–æ—Ç —Å—Ç–∞–ª –∫—Ä–∞—Å–Ω—ã–º

### üìä SQL –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ—Ç–æ–≤:
```sql
SELECT 
    ts.id,
    ts.slot_date,
    ts.start_time,
    ts.end_time,
    ts.is_available,
    p.full_name as expert_name
FROM time_slots ts
LEFT JOIN profiles p ON p.id = ts.expert_id
WHERE ts.slot_date >= CURRENT_DATE
ORDER BY ts.slot_date, ts.start_time;
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π:
```sql
SELECT 
    b.id,
    b.booking_date,
    b.start_time,
    b.end_time,
    b.status,
    expert.full_name as expert_name,
    client.full_name as client_name
FROM bookings b
LEFT JOIN profiles expert ON expert.id = b.expert_id
LEFT JOIN profiles client ON client.id = b.client_id
WHERE b.booking_date >= CURRENT_DATE
ORDER BY b.booking_date, b.start_time;
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏ —Å–ª–æ—Ç–æ–≤ –∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π:
```sql
SELECT 
    ts.slot_date,
    ts.start_time,
    ts.end_time,
    ts.is_available,
    CASE 
        WHEN b.id IS NOT NULL THEN '–ï—Å—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ'
        ELSE '–ù–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è'
    END as booking_status,
    b.status as booking_status_detail,
    client.full_name as client_name
FROM time_slots ts
LEFT JOIN bookings b ON b.slot_id = ts.id AND b.status IN ('pending', 'confirmed')
LEFT JOIN profiles client ON client.id = b.client_id
WHERE ts.slot_date >= CURRENT_DATE
ORDER BY ts.slot_date, ts.start_time;
```

### üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- ‚úÖ **–°–∏–Ω–∏–µ —Å–ª–æ—Ç—ã** - –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ **–ö—Ä–∞—Å–Ω—ã–µ —Å–ª–æ—Ç—ã** - —É–∂–µ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω—ã —Å –∏–º–µ–Ω–µ–º –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ **–ü–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ü–∏—Ñ—Ä—ã
- ‚úÖ **–ö–æ–Ω—Å–æ–ª—å** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `–¥–æ—Å—Ç—É–ø–µ–Ω=false` –¥–ª—è –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤

### üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ **–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ—Ç—ã** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
- ‚úÖ **–ü–æ–º–µ—á–∞—Ç—å —Å–ª–æ—Ç—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º–∏** –ø—Ä–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
- ‚úÖ **–û—Å–≤–æ–±–æ–∂–¥–∞—Ç—å —Å–ª–æ—Ç—ã** –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ **–û–±–Ω–æ–≤–ª—è—Ç—å UI** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏ –∏ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏! üîß
